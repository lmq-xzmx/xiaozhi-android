# ğŸ¯ STTåŠŸèƒ½éªŒè¯æŒ‡å—

## ğŸ“Š å½“å‰çŠ¶æ€

âœ… **ä»£ç å·²ä¿®æ”¹**ï¼šDeviceInfo.ktä¸­çš„è®¾å¤‡IDå·²è®¾ç½®ä¸ºå›ºå®šå€¼ `00:11:22:33:44:55`

## ğŸš€ éªŒè¯æ­¥éª¤

### ç¬¬1æ­¥ï¼šæ£€æŸ¥è®¾å¤‡ç»‘å®šçŠ¶æ€

**æ–¹æ³•1ï¼šä½¿ç”¨Terminalï¼ˆéPowerShellï¼‰**
```bash
curl -X POST \
  -H "Content-Type: application/json" \
  -H "Device-Id: 00:11:22:33:44:55" \
  -H "Client-Id: android-app" \
  -d '{
    "mac_address": "00:11:22:33:44:55",
    "application": {"version": "1.0.0"},
    "board": {"type": "android"},
    "chip_model_name": "android"
  }' \
  http://47.122.144.73:8002/xiaozhi/ota/
```

**æ–¹æ³•2ï¼šä½¿ç”¨Pythonï¼ˆå¦‚æœcurlä¸å¯ç”¨ï¼‰**
```python
import requests
import json

response = requests.post(
    "http://47.122.144.73:8002/xiaozhi/ota/",
    headers={
        "Content-Type": "application/json",
        "Device-Id": "00:11:22:33:44:55",
        "Client-Id": "android-app"
    },
    json={
        "mac_address": "00:11:22:33:44:55",
        "application": {"version": "1.0.0"},
        "board": {"type": "android"},
        "chip_model_name": "android"
    }
)

result = response.json()
if "activation" in result:
    print(f"éœ€è¦ç»‘å®šï¼Œæ¿€æ´»ç : {result['activation']['code']}")
elif "websocket" in result:
    print("è®¾å¤‡å·²ç»‘å®šï¼Œå¯ä»¥æµ‹è¯•STT")
else:
    print("æ„å¤–å“åº”:", result)
```

### ç¬¬2æ­¥ï¼šè®¾å¤‡ç»‘å®šï¼ˆå¦‚æœéœ€è¦ï¼‰

å¦‚æœç¬¬1æ­¥è¿”å›æ¿€æ´»ç ï¼Œè¯·æ‰§è¡Œï¼š

1. **è®¿é—®ç®¡ç†é¢æ¿**ï¼šhttp://47.122.144.73:8002/#/device-management?agentId=6bf580ad09cf4b1e8bd332dafb9e6d30
2. **è¾“å…¥æ¿€æ´»ç **ï¼šåœ¨è®¾å¤‡ç»‘å®šç•Œé¢è¾“å…¥è·å¾—çš„6ä½æ•°å­—æ¿€æ´»ç 
3. **ç¡®è®¤ç»‘å®š**ï¼šå®Œæˆè®¾å¤‡ç»‘å®šæ“ä½œ

### ç¬¬3æ­¥ï¼šæ¸…é™¤åº”ç”¨æ•°æ®ï¼ˆé‡è¦ï¼ï¼‰

**æ–¹æ³•1ï¼šä½¿ç”¨ADBå‘½ä»¤**
```bash
adb shell pm clear info.dourok.voicebot
```

**æ–¹æ³•2ï¼šæ‰‹åŠ¨æ¸…é™¤**
1. åœ¨Androidè®¾å¤‡ä¸Šæ‰“å¼€"è®¾ç½®"
2. è¿›å…¥"åº”ç”¨ç®¡ç†" æˆ– "åº”ç”¨"
3. æ‰¾åˆ°"VoiceBot"åº”ç”¨
4. ç‚¹å‡»"å­˜å‚¨"
5. ç‚¹å‡»"æ¸…é™¤æ•°æ®"

**ä¸ºä»€ä¹ˆè¦æ¸…é™¤æ•°æ®ï¼Ÿ**
- ç¡®ä¿åº”ç”¨ä½¿ç”¨æ–°çš„å›ºå®šè®¾å¤‡ID
- æ¸…é™¤æ—§çš„éšæœºè®¾å¤‡IDç¼“å­˜
- é‡æ–°åˆå§‹åŒ–è®¾å¤‡ä¿¡æ¯

### ç¬¬4æ­¥ï¼šé‡æ–°ç¼–è¯‘å’Œè¿è¡Œåº”ç”¨

1. **é‡æ–°ç¼–è¯‘**Androidé¡¹ç›®
2. **å®‰è£…åˆ°è®¾å¤‡**
3. **å¯åŠ¨åº”ç”¨**

### ç¬¬5æ­¥ï¼šéªŒè¯STTåŠŸèƒ½

#### 5.1 æ£€æŸ¥è®¾å¤‡IDæ—¥å¿—

åœ¨`WebsocketProtocol.kt`æ–‡ä»¶ç¬¬79è¡Œé™„è¿‘æ·»åŠ æ—¥å¿—ï¼š
```kotlin
.addHeader("Device-Id", deviceInfo.mac_address)
Log.d("DeviceInfo", "Current Device-Id: ${deviceInfo.mac_address}")
```

**é¢„æœŸç»“æœ**ï¼šæ—¥å¿—åº”æ˜¾ç¤º `Current Device-Id: 00:11:22:33:44:55`

#### 5.2 éªŒè¯WebSocketè¿æ¥

**é¢„æœŸè¡Œä¸º**ï¼š
- âœ… WebSocketè¿æ¥æˆåŠŸ
- âœ… æ²¡æœ‰ç»‘å®šé”™è¯¯æç¤º
- âœ… åº”ç”¨æ­£å¸¸åˆå§‹åŒ–

#### 5.3 æµ‹è¯•STTåŠŸèƒ½

1. **ç‚¹å‡»å½•éŸ³æŒ‰é’®**
2. **è¯´è¯æµ‹è¯•**ï¼šè¯´ä¸€äº›ç®€å•çš„è¯
3. **è§‚å¯Ÿç»“æœ**ï¼š
   - âœ… åº”è¯¥æ˜¾ç¤ºè½¬å½•çš„æ–‡å­—
   - âœ… æ²¡æœ‰"éœ€è¦ç»‘å®šè®¾å¤‡"çš„æç¤º
   - âœ… STTåŠŸèƒ½æ­£å¸¸å·¥ä½œ

## ğŸ” æ•…éšœæ’é™¤

### é—®é¢˜1ï¼šè®¾å¤‡IDä»ç„¶æ˜¯éšæœºçš„

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ç¡®è®¤ä»£ç ä¿®æ”¹æ­£ç¡®
- å®Œå…¨æ¸…é™¤åº”ç”¨æ•°æ®
- é‡æ–°ç¼–è¯‘å®‰è£…

### é—®é¢˜2ï¼šWebSocketè¿æ¥å¤±è´¥

**æ£€æŸ¥é¡¹ç›®**ï¼š
- ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
- WebSocket URLæ˜¯å¦æ­£ç¡®
- è®¾å¤‡æ˜¯å¦å·²æ­£ç¡®ç»‘å®š

### é—®é¢˜3ï¼šSTTä»ç„¶ä¸å·¥ä½œ

**å¯èƒ½åŸå› **ï¼š
- è®¾å¤‡ç»‘å®šæœªå®Œæˆ
- è®¾å¤‡IDä¸åŒ¹é…
- æœåŠ¡å™¨ç«¯é—®é¢˜

**éªŒè¯æ–¹æ³•**ï¼š
- é‡æ–°æ£€æŸ¥è®¾å¤‡ç»‘å®šçŠ¶æ€
- æŸ¥çœ‹åº”ç”¨æ—¥å¿—ä¸­çš„è®¾å¤‡ID
- ç¡®è®¤WebSocketè¿æ¥çŠ¶æ€

## ğŸ“± æˆåŠŸæ ‡å¿—

### å®Œå…¨æˆåŠŸçš„STTåº”è¯¥æ˜¾ç¤ºï¼š

1. **æ—¥å¿—è¾“å‡º**ï¼š
   ```
   Current Device-Id: 00:11:22:33:44:55
   WebSocket connected successfully
   ```

2. **åº”ç”¨è¡Œä¸º**ï¼š
   - è¯­éŸ³è¯†åˆ«æŒ‰é’®å¯ç”¨
   - è¯´è¯åæ˜¾ç¤ºè½¬å½•æ–‡å­—
   - æ²¡æœ‰é”™è¯¯æç¤º

3. **æœåŠ¡å™¨å“åº”**ï¼š
   - WebSocketæ¶ˆæ¯æ­£å¸¸
   - STTå“åº”åŠæ—¶
   - æ²¡æœ‰ç»‘å®šé”™è¯¯

## ğŸ¯ å¿«é€ŸéªŒè¯å‘½ä»¤

åˆ›å»ºè¿™ä¸ªå¿«é€Ÿæµ‹è¯•è„šæœ¬ï¼š

```bash
# åˆ›å»º quick_stt_test.sh
echo '#!/bin/bash
echo "=== STTåŠŸèƒ½å¿«é€ŸéªŒè¯ ==="
echo "1. æ£€æŸ¥è®¾å¤‡ç»‘å®šçŠ¶æ€..."

curl -s -X POST \
  -H "Content-Type: application/json" \
  -H "Device-Id: 00:11:22:33:44:55" \
  -H "Client-Id: android-app" \
  -d "{\"mac_address\":\"00:11:22:33:44:55\",\"application\":{\"version\":\"1.0.0\"},\"board\":{\"type\":\"android\"},\"chip_model_name\":\"android\"}" \
  http://47.122.144.73:8002/xiaozhi/ota/ | python3 -m json.tool

echo ""
echo "2. å¦‚æœçœ‹åˆ°activationå­—æ®µï¼Œè¯·åˆ°ç®¡ç†é¢æ¿ç»‘å®šè®¾å¤‡"
echo "3. å¦‚æœåªçœ‹åˆ°websocketå­—æ®µï¼Œè¯´æ˜å·²ç»‘å®šï¼Œå¯ä»¥æµ‹è¯•STT"
echo "4. è®°å¾—æ¸…é™¤åº”ç”¨æ•°æ®åé‡æ–°è¿è¡Œï¼"
' > quick_stt_test.sh

chmod +x quick_stt_test.sh
./quick_stt_test.sh
```

---
**å…³é”®æé†’**ï¼šä¿®æ”¹ä»£ç ååŠ¡å¿…æ¸…é™¤åº”ç”¨æ•°æ®ï¼Œè¿™æ˜¯æœ€å®¹æ˜“å¿½ç•¥ä½†æœ€é‡è¦çš„æ­¥éª¤ï¼ 